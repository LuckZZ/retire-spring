<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head th:include="fragments/head::head_section('新增管理员')">
</head>

<body data-type="widgets">
    <script th:src="@{/assets/js/theme.js}"></script>
    <div class="am-g tpl-g">
        <!-- 头部 -->
        <div th:replace="fragments/header::header_section(Admin)"></div>
        <!-- 风格切换 -->
        <div th:replace="fragments/theme::theme_section"></div>
        <!-- 侧边导航栏 -->
        <div th:replace="fragments/left_admin::left_section('adminList')"></div>

        <!-- 内容区域 -->
        <div class="tpl-content-wrapper">
            <div class="row-content am-cf">
                <div class="row">

                    <div class="am-u-sm-12 am-u-md-12 am-u-lg-12">
                        <div class="widget am-cf">
                            <div class="widget-head am-cf">
                                <div class="widget-title am-fl">新增管理员 </div>
                                <div class="widget-function am-fr">
                                    <a href="javascript:;" class="am-icon-cog"></a>
                                </div>
                            </div>
                            <div class="widget-body am-fr">

                                <form class="am-form tpl-form-border-form tpl-form-border-br" id="doc-vld-msg" action="#" method="post" th:object="${admin}">

                                    <div class="am-form-group">
                                        <label for="jobNum" class="am-u-sm-3 am-form-label">工号</label>
                                        <div class="am-u-sm-9">
                                            <!--本地验证和ajax验证-->
                                            <input name="jobNum" minlength="6" maxlength="6" type="number" class="tpl-form-input" id="jobNum" placeholder="输入工号(6位)" required/>
                                        </div>
                                    </div>

                                    <div class="am-form-group">
                                        <label for="name" class="am-u-sm-3 am-form-label">姓名</label>
                                        <div class="am-u-sm-9">
                                            <input name="name"type="text" class="tpl-form-input" id="name" placeholder="输入姓名" required>
                                        </div>
                                    </div>

                                    <div class="am-form-group">
                                        <label for="password" class="am-u-sm-3 am-form-label">密码</label>
                                        <div class="am-u-sm-9">
                                            <input name="password" type="password" minlength="6" maxlength="10" class="tpl-form-input" id="password" placeholder="输入密码(6-10位)" required>
                                        </div>
                                    </div>

                                    <div class="am-form-group">
                                        <label for="passwordCfm" class="am-u-sm-3 am-form-label">确认密码</label>
                                        <!--data-equal-to密码验证-->
                                        <div class="am-u-sm-9">
                                            <input name="passwordCfm" type="password" minlength="6" maxlength="10" class="tpl-form-input" id="passwordCfm" placeholder="再次输入密码" required>
                                        </div>
                                    </div>


                                    <div class="am-form-group">
                                        <label for="user-intro" class="am-u-sm-3 am-form-label">允许登陆</label>
                                        <div class="am-u-sm-9">
                                            <div class="tpl-switch">
                                                <!--被选择value为yes、否则为null-->
                                                <input type="checkbox" id="user-intro" class="ios-switch bigswitch tpl-switch-btn" value="yes" name="canLogin">
                                                <div class="tpl-switch-btn-view">
                                                    <div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="am-form-group">
                                        <div class="am-u-sm-9 am-u-sm-push-3">
                                            <button type="submit" id="adminAdd" class="am-btn am-btn-primary tpl-btn-bg-color-success" data-am-loading="{spinner: 'circle-o-notch', loadingText: '提交中...'}">提交</button>
                                        </div>
                                    </div>

                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </div>
    <div th:replace="fragments/footer::js"></div>
</body>


<script src="http://static.runoob.com/assets/jquery-validation-1.14.0/lib/jquery.js"></script>
<script src="http://static.runoob.com/assets/jquery-validation-1.14.0/dist/jquery.validate.min.js"></script>
<script src="http://static.runoob.com/assets/jquery-validation-1.14.0/dist/localization/messages_zh.js"></script>

<script>

    $(function() {
        // 提交时验证表单
        //small元素包裹错误信息
        $("#doc-vld-msg").validate({
            rules:{
                jobNum: {
                    required: true,
                    remote: {
                        url: '/admin/exist',
                        type: "post",
                        dataType: "json",
                        data: {
                            jobNum: function () {
                                return $("#jobNum").val();
                            }
                        }
                    }
                },
                password:{

                },
                passwordCfm:{
                    equalTo:"#password"
                }
            },

            errorPlacement: function(error, element) {
                $( element ).closest( "div" ).append( error );
            },
            errorElement: "small",
            messages:{
                jobNum:{
                    minlength: "工号必须6位",
                    maxlength: "工号必须6位",
                    remote:"此工号已存在，重新输入"
                },
                passwordCfm:"两次密码输入不一致"
            },
            submitHandler:function(form){
                var myform = $("#doc-vld-msg");
                $.ajax({
                    url: "/admin/save",
                    type: myform.attr("method"),
                    data: myform.serialize(),
                    dataType: "json",
                    error: function ()
                    {
                        console.log("This is error!");
                    },
                    complete:function () {
                        // $("#ajax-loader").hide();
                        console.log("This is complete!");
                    },
                    success: function (data)
                    {
                        // $("#article").html(data);
                        console.log("This is success!");
                    }
                });

            }
        });

    });
</script>

<style>
    .error{
        color:red;
    }
</style>


</html>